# ============================================================================
# Formation-Containment Control Parameters - MANUAL OFFSETS EXAMPLE
# ============================================================================
# This configuration demonstrates loading leader offsets from a custom file.
# The formation shape is defined in config/leader_offsets.txt
#
# Based on: "Collision-Free Formation-Containment Control Based on Adaptive
# Sliding Mode Strategy for a Quadrotor Fleet Under Disturbances"
# Authors: Carlos Katt, Herman Castañeda (2025)
# ============================================================================

# ROS 2 Parameter File Format - applies to all nodes
/**:
  ros__parameters:
    # ============================================================================
    # AGENT CONFIGURATION
    # ============================================================================
    # Number of follower agents (n in paper)
    n_followers: 1

    # Number of leader agents (m in paper)
    # NOTE: This should match the number of leaders defined in leader_offsets.txt
    n_leaders: 5

    # Graph topology: "paper", "complete", "ring"
    topology: "ring"

    # ============================================================================
    # FORMATION CONFIGURATION - CUSTOM OFFSETS
    # ============================================================================
    # Formation type: set to "custom" to use offsets from YAML file
    formation_type: "custom"

    # Path to the leader offsets YAML file
    # Supports absolute paths or paths relative to the package share directory
    # Set by launch file or provide absolute path here
    offsets_file: ""  # Will be set by launch file (config/leader_offsets.yaml)

    # Formation scale (meters) - used as fallback if file not found
    formation_scale: 1.0

    # Formation height (meters) - base altitude
    formation_height: 0.0

    # ============================================================================
    # CONTROL PARAMETERS (From Section 4 of paper)
    # ============================================================================
    # Sliding surface parameter λ (Equation 26)
    lambda_gain: 3.0

    # Adaptive law precision parameter α (Equation 30)
    alpha: 4.0

    # Adaptive law control effort parameter β (Equation 30)
    beta: 0.125

    # Safety distance γ_s (Equation 6) for collision avoidance (meters)
    safety_distance: 1.0

    # Enable/disable collision avoidance
    use_collision_avoidance: true

    # Maximum velocity limit (m/s)
    max_velocity: 1.0

    # ============================================================================
    # TIMING CONFIGURATION
    # ============================================================================
    # Control loop rate (Hz)
    control_rate: 50.0

    # Control timestep (seconds)
    dt: 0.02

    # ============================================================================
    # DRONE CONFIGURATION
    # ============================================================================
    # Drone topic prefix
    drone_prefix: "cf"

    # Follower drone IDs
    follower_ids: [11, 12, 13, 14, 15, 16, 17, 18, 19, 20]

    # Leader drone IDs - must match n_leaders
    leader_ids: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

    # ============================================================================
    # FRAME CONFIGURATION
    # ============================================================================
    world_frame: "world"

    # ============================================================================
    # INITIAL CONDITIONS
    # ============================================================================
    # Follower initial position
    initial_follower_positions: [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 4.0, 0.0, 0.0, 4.0, 1.0, 0.0, 5.0, 0.0, 0.0, 5.0, 1.0, 0.0]

    # Leader initial positions
    initial_leader_positions: [-1.0, 0.0, 0.0, -1.0, 1.0, 0.0, -2.0, 0.0, 0.0, -2.0, 1.0, 0.0, -3.0, 0.0, 0.0, -3.0, 1.0, 0.0, -4.0, 0.0, 0.0, -4.0, 1.0, 0.0, -5.0, 0.0, 0.0, -5.0, 1.0, 0.0]

    # Initial yaw angles
    initial_yaw: 3.14159

    # ============================================================================
    # VIRTUAL LEADER TRAJECTORY
    # ============================================================================
    
    # Trajectory type: "lemniscate", "circle", "hover", "square"
    trajectory_type: "circle"

    # Trajectory scale (meters)
    trajectory_scale: 1.0

    # Trajectory height (meters)
    trajectory_height: 1.0

    # Trajectory period (seconds)
    trajectory_period: 20.0

    # Start delay before motion begins (seconds)
    start_delay: 5.0

      # ==========================================================================
      # TASKs:
      # - Establecer el punto de inicio de la trayectoria (x, y, z)
      # - Establecer la orientación inicial del líder virtual (yaw)
      # - Establecer la velocidad de la trayectoria
      # - Establecer la aceleración de la trayectoria
      # - Establecer la desaceleración de la trayectoria
      # - Establecer la deceleración de la trayectoria
      # - Establecer la deceleración de la trayectoria
      # ==========================================================================

    # ============================================================================
    # SIMULATION CONFIGURATION
    # ============================================================================
    simulation_rate: 100.0
    use_turbulence: false
    turbulence_start_time: 45.0
    turbulence_intensity: 0.3

    # ============================================================================
    # VISUALIZATION
    # ============================================================================
    trajectory_length: 500
    visualization_rate: 10.0

    # ============================================================================
    # CRAZYSWARM2 BRIDGE
    # ============================================================================
    control_mode: "velocity"
    use_takeoff_service: true
    default_height: 1.0



